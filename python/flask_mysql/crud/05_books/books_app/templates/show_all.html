{% extends 'base_templates/base.html' %}

{% block title %}Authors{% endblock %}

{% block content %}
    <div class="flex-wrapper">

        {% if page == 'author' %}
            <div class="col">
                <h2>{{ author.first_name }} {{ author.last_name }}</h2>
                <h4>Number of books read by club Memebers</h4>
                <h4>{{ num_of_books }}</h4>
            </div>
            <div class="col">
                <h2>Books Read</h2>
                <table>
                    <tr>
                        <th>Title</th>
                        <th>Number of Pages</th>
                    </tr>
                    {% for book in author.books %}
                        <tr>
                            <td><a href="/books/{{book.id}}">{{book.title}}</a></td>
                            <td>{{book.num_of_pages}}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>


        {% elif page == 'book' %}
            <div class="col">
                
                <h2>{{ book.title }}</h2>
                <h3>By </h3>
                <h4>People who liked this book</h4>
                <table>
                    <tr><th>First Name</th><th>Last Name</th></tr>
                    {% for user in book.users_who_liked_this_book %}
                        <tr>
                            <td>{{user.first_name}}</td><td>{{user.last_name}}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
            <div class="col">
                <h2>New Favorite?</h2>
                <form class="flex-wrapper" action="/new_favorite" method="POST">
                    <input type="hidden" name="book_id" value="{{ book.id }}">
                    <label for="user">
                        Add Name:
                    </label>
                    <select name="user_id" id="user">
                        {% for user in users %}
                            <option value="{{user.id}}">{{user.first_name}} {{user.last_name}}</option>
                        {% endfor %}
                    </select>
                    <h6>New User? <a href="/users">Click Here</a></h6>
                    <input type="submit" value="Like Book">
                </form>
            </div>


        {% else %}
            <div class="col">
                <h2>{{ user.first_name }} {{ user.last_name }}</h2>
                <h3>Joined {{ user.created_at.strftime('%B %d, %Y') }}</h3>
                <h4>Favorite Books</h4>
                <table>
                    <tr>
                        <th>Title</th>
                        <th>Number of Pages</th>
                    </tr>
                    {% for book in user.favorites %}
                        <tr>
                            <td><a href="/books/{{book.id}}">{{ book.title }}</a></td>
                            <td>{{ book.num_of_pages }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
            <div class="col">
                <h2>Have a new Favorite Book?</h2>
                <form class="flex-wrapper" action="/new_favorite" method="POST">
                    <input type="hidden" name="user_id" value="{{user.id}}">
                    <label for="book_id">
                        Which book?
                    </label>
                    <select name="book_id" id="book_id">
                        {% for book in books %}
                            <option value="{{book.id}}">{{book.title}}</option>
                        {% endfor %}
                    </select>
                    <h6>Book not here? <a href="/books">Click Here</a></h6>
                    <input type="submit" value="Add Favorite">
                </form>
            </div>
        {% endif %}
    </div>
{% endblock %}